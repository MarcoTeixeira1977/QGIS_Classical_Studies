# 7. Module: Vector Analysis
Now that you have edited a few features, you must want to know what else one can do with them. Having features with attributes is nice, but when all is said and done, this doesn’t really tell you anything that a normal, non-GIS map can’t.

The key advantage of a GIS is this: _a GIS can answer questions_.

For the next three modules, we’ll endeavor to answer a _research question_ using GIS functions. For example, you are an estate agent and you are looking for a residential property in Swellendam for clients who have the following criteria:

1. It needs to be in ~Swellendam~.
2. It must be within reasonable driving distance of a school (say 1km).
3. It must be more than 100m squared in size.
4. Closer than 50m to a main road.
5. Closer than 500m to a restaurant.

Within the next few modules, we’ll harness the power of GIS analysis tools to locate suitable farm properties for this new residential development.

## 7.1. Lesson: Reprojecting and Transforming Data
Let us talk about Coordinate Reference Systems (CRSs) again. We have touched on this briefly before, but haven’t discussed what it means practically.

**The goal for this lesson:** To reproject and transform vector datasets.

### 7.1.1. ![basic](https://github.com/Toletum-Network/AutumnSchool_2020/blob/master/Icons/basic.png) Follow Along: Projections
The CRS that all the data, as well as the map itself are in right now is called ~WGS84~. This is a very common Geographic Coordinate System (GCS) for representing data. But there’s a problem, as we will see.

1. Save your current map
3. Then open the map of the world which you will find under _exercise_data/world/world.qgs_
4. Zoom in to Spain by using the Zoom In tool
5. Try setting a scale in the **``Scale``** field, which is in the _Statusbar_ along the bottom of the screen. While over Spain, set this value to _1:5 000 000_ (one to five million).
6. Pan around the map while keeping an eye on the Scale field

Notice the scale changing? That’s because you are moving away from the one point that you zoomed into at _1:5 000 000_, which was at the center of your screen. All around that point, the scale is different.

To understand why, think about a globe of the Earth. It has lines running along it from North to South. These longitude lines are far apart at the equator, but they meet at the poles.

In a GCS, you are working on this sphere, but your screen is flat. When you try to represent the sphere on a flat surface, distortion occurs, similar to what would happen if you cut open a tennis ball and tried to flatten it out. What this means on a map is that the longitude lines stay equally far apart from each other, even at the poles (where they are supposed to meet). This means that, as you travel away from the equator on your map, the scale of the objects that you see gets larger and larger. What this means for us, practically, is that there is no constant scale on our map!

To solve this, let’s use a Projected Coordinate System (PCS) instead. A PCS “projects” or converts the data in a way that makes allowance for the scale change and corrects it. Therefore, to keep the scale constant, we should reproject our data to use a PCS.

### 7.1.2. ![basic](https://github.com/Toletum-Network/AutumnSchool_2020/blob/master/Icons/basic.png) Follow Along: “On the Fly” Reprojection
By default, QGIS reprojects data “on the fly”. What this means is that even if the data itself is in another CRS, QGIS can project it as if it were in a CRS of your choice.

You can change the CRS of the project by clicking on the ![projectionEnabled](https://github.com/Toletum-Network/AutumnSchool_2020/blob/master/Icons/mIconProjectionEnabled.png)_Current projection_ button in the bottom right corner of QGIS.

1. In the dialog that appears, type the word _global_ into the **``Filter``** field. A few CRSs should appear in the **``Predefined Reference Systems``** field below.
2. Select ~WGS 84 / NSIDC EASE-Grid 2.0 Global | EPSG:6933~ entry by clicking on it, and then click **``OK``**.
   Notice how the shape of South Africa changes. All projections work by changing the apparent shapes of objects on Earth.
3. Zoom to a scale of 1:5 000 000 again, as before.
4. Pan around the map.

Notice how the scale stays the same!

“On the fly” reprojection is also used for combining datasets that are in different CRSs.

1. Add another vector layer to your map which has the data for Spain only. You will find it as _exercise_data/world/RSA.shp_.
2. Load it. A quick way to see its CRS is by hovering the mouse over the layer in the legend. It is ~_EPSG:3410_~.
   What do you notice?

The layer is visible even if it has a different CRS from the **``continents``** one.

### 7.1.3. ![moderate](https://github.com/Toletum-Network/AutumnSchool_2020/blob/master/Icons/moderate.png) Follow Along: Saving a Dataset to Another CRS
Sometimes you need to export an existing dataset with another CRS. As we will see in the next lesson, if you need to make distance calculations on layer, it is always better to have the layer in a projected coordinate system.

Be aware that the ‘on the fly’ reprojection is related to the **project** and not to single layers. This means that a layer can have a different CRS from the project even if you see it in the correct position.

You can easily export the layer with another CRS.

1. Add the ~_buildings_~ dataset from ~_training_data.gpkg_~
2. Right-click on the ~_buildings_~ layer in the **``Layers``** panel
3. Select **``Export ‣ Save Features As…``** in the menu that appears. You will be shown the **``Save Vector Layer as…``** dialog.
4. Click on the **``Browse``** button next to the **``File name``** field
5. Navigate to _exercise_data/_ and specify the name of the new layer as ~_buildings_reprojected.shp_~.
6. Change the value of the **``CRS``**. Only the recent CRSs used will be shown in the drop-down menu. Click on the ![setProjection](https://github.com/Toletum-Network/AutumnSchool_2020/blob/master/Icons/mActionSetProjection.png)_Select projection_ button next to the drop-down menu.
7. The **``Coordinate Reference System Selector``** dialog will appear. In its **``Filter``** field, search for ~_30N_~.
8. Select ~**``WGS 84 / UTM zone 34S | EPSG:32734``**~ from the list

![7.1.3 A]()

9. Leave the other options unchanged. The **``Save Vector Layer as…``** dialog now looks like this:

![7.1.3 B]()

10. Click **``OK``**

You can now compare the old and new projections of the layer and see that they are in two different CRS but they are still overlapping.

### 7.1.4. In Conclusion
Different projections are useful for different purposes. By choosing the correct projection, you can ensure that the features on your map are being represented accurately.

### 7.1.6. Further Reading
Materials for the Advanced section of this lesson were taken from [this article](https://anitagraser.com/2012/03/18/beautiful-global-projections-adding-custom-projections-to-qgis/).

Further information on Coordinate Reference Systems is available [here](https://linfiniti.com/dla/worksheets/7_CRS.pdf).

### 7.1.7. What’s Next?
In the next lesson you will learn how to analyze vector data using QGIS’ various vector analysis tools.
